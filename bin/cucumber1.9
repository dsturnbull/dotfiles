#!/usr/bin/env ruby1.9
# Add '.rb' to work around a bug in IronRuby's File#dirname
t = "/opt/local/lib/ruby1.9/gems/1.9.1/gems/cucumber-0.3.11/lib"
$:.unshift(t) unless $:.include?(t)

require 'cucumber/rspec_neuter'
require 'cucumber/cli/main'
begin
  # The dup is to keep ARGV intact, so that tools like ruby-debug can respawn.
  failure = Cucumber::Cli::Main.execute(ARGV.dup)
  Kernel.exit(failure ? 1 : 0)
rescue SystemExit => e
  Kernel.exit(e.status)
rescue Exception => e
  STDERR.puts("#{e.message} (#{e.class})")
  STDERR.puts(e.backtrace.join("\n"))
  Kernel.exit 1
end
