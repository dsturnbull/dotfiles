#!/usr/bin/env ruby

require 'rubygems'
require 'pp'
require 'logger'

IGNORES = %w(HEAD master)
MATCHES = %w(PL-)

ignores = IGNORES.map { |i| (" | grep -v #{i}") }.join
matches = MATCHES.map { |i| (" | grep #{i}") }.join
@branches = `git branch -r #{ignores} #{matches}`.split
@unmerged = `git branch -r --no-merged`.split
@deleting = @branches - @unmerged

@deleting.each do |branch|
  branch.sub!(/^origin\//, '')
  puts "git checkout -b #{branch} origin/#{branch} && git push origin :#{branch} && git checkout master && git branch -D #{branch}"
end
